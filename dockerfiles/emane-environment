# What image do we start from
FROM ubuntu:20.04

RUN apt-get update
RUN apt-get install -y build-essential curl apt-utils wget unzip
RUN apt install -y net-tools iputils-ping
RUN apt-get install -y nano
RUN apt-get install -y vim

RUN apt update
RUN apt-get install --fix-broken -y python3-pip
RUN apt-get install -y python3

RUN apt install -y git

# Emane requirnments 
ENV DEBIAN_FRONTEND noninteractive # preventing dialog error 

RUN apt-get install -y gcc g++ autoconf automake libtool libxml2-dev libprotobuf-dev \
    libpcap-dev libpcre3-dev uuid-dev debhelper pkg-config protobuf-compiler git dh-python \
    python3-protobuf python3-setuptools


RUN git clone https://github.com/adjacentlink/emane.git

# RUN apt --fix-broken install -y

RUN cd emane && \
    ./autogen.sh && \
    ./configure && \
    make deb
RUN cd emane/.debbuild && \
    dpkg -i *.deb 2> /dev/null || true # we know this will cuase an error to accure, we're gonna fix it in the next line and we don't want to pause and break the procces
                                       # so we pass it with '|| true'
RUN apt --fix-broken install -y
RUN apt-get install -f

RUN mkdir /emane-tutorial